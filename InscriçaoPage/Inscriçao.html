<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>Inscrição</title>
    <link rel="stylesheet" href="inscriçao.css">
  </head>
<body>
<img src="../imagens/logoTCC.jpg" alt="logo" class="logo">
  <form id="formInscricao">
    <label for="nome">Nome</label>
    <input type="text" id="nome" required>

    <label for="endereco">Endereço</label>
    <input type="text" id="endereco" required>

    <label for="email">Email</label>
    <input type="text" id="email" required>

    <label for="dia">Escolha um dia da semana</label>
    <select id="dia" required>
      <option value="">Selecione</option>
      <option value="segunda">Segunda-feira</option>
      <option value="terca">Terça-feira</option>
      <option value="quarta">Quarta-feira</option>
      <option value="quinta">Quinta-feira</option>
      <option value="sexta">Sexta-feira</option>
    </select>

    <button type="submit" onclick="baixarPDF()">ENVIAR</button>
    <div class="mensagem" id="mensagem"></div>
  </form>

  <script>
    const form = document.getElementById("formInscricao");
    const mensagem = document.getElementById("mensagem");

    form.addEventListener("submit", async (e) => {
      e.preventDefault();

      const dados = {
        nome: document.getElementById("nome").value,
        endereco: document.getElementById("endereco").value,
        email: document.getElementById("email").value,
        dia: document.getElementById("dia").value,
      };

      try {
        const response = await fetch("http://localhost:5000/inscricao", {
          method: "POST",
          headers: {
            "Content-Type": "application/json"
          },
          credentials: "include",
          body: JSON.stringify(dados)
        });

        const resultado = await response.json();

        if (response.ok) {
          mensagem.textContent = "Inscrição realizada com sucesso!";
          mensagem.style.color = "lime";
          form.reset();
        } else {
          mensagem.textContent = "Erro: " + resultado.message;
          mensagem.style.color = "yellow";
        }

      } catch (error) {
        mensagem.textContent = "Erro de conexão com o servidor.";
        mensagem.style.color = "orange";
      }
    });

    function baixarPDF() {
      if (!document.getElementById("nome").value || 
          !document.getElementById("endereco").value || 
          !document.getElementById("email").value || 
          !document.getElementById("dia").value) {
        alert("Por favor, preencha todos os campos antes de baixar o PDF.");
        return;
      }
      else {
      const link = document.createElement('a');
      link.href = 'pagamento_pdf.pdf';
      link.download = 'pagamento_pdf.pdf';
      link.click();
    }
  }
  </script>

</body>
</html>